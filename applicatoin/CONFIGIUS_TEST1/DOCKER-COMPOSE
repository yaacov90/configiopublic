version: '3.5'
services:
  configiusfe:
    image: configius_fe
    container_name: configius_fe
    ports: 
      - "{{ CONFIGIUSFE_PORT }}:80"
  configiusbe:
    image: configius_be
    container_name: configius_be
    ports:
      - "{{ CONFIGIUSBE_PORT }}:3000"
    environment:
      ENV_LOG_ACTIVE_SINCE_MINUTES: {{ ENV_LOG_ACTIVE_SINCE_MINUTES }}
      ENV_GIT_WORK_DIR: /tmp/git
      ENV_GIT_REPONAME: {{ ENV_GIT_REPONAME }}
      ENV_GIT_KEY_DIR: /tmp/git
      ENV_GIT_KEY_FILE_NAME: git_key_file
      GIT_SSH_COMMAND: ssh -i /tmp/git/git_key_file -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no
    volumes:
      - git_work_dir:/tmp/git
volumes:
  git_work_dir:
    driver: local
    driver_opts:
      type: none
      device: {{ GIT_WORK_DIR }}
      o: bind


